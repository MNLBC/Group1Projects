{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "Windows",
        "mixins": [
            "{",
            "GlobalUtill : 'com.oocl.mnlbc.GlobalMessage'",
            "}"
        ],
        "oLoadingMessageMask": [
            "null"
        ]
    },
    "name": "MyController",
    "configAlternates": {
        "oLoadingMessageMask": "object"
    },
    "designerId": "a7aa32de-c51e-4381-8f6d-51a5345c3a54",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "oLoadingMessageMask",
            "type": "string"
        }
    ],
    "cn": [
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productName",
                "selector": "#ProductName"
            },
            "name": "productName",
            "designerId": "57ad7885-3622-4e69-9493-0cc8e2b70ea9"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productPrice",
                "selector": "#ProductPrice"
            },
            "name": "productPrice",
            "designerId": "1fbe6506-7d4a-464d-8ff6-d868b9209821"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productDescription",
                "selector": "#ProductDescription"
            },
            "name": "productDescription",
            "designerId": "4824c5fc-1a98-4db2-97d4-92740040e7d4"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productQuantity",
                "selector": "#ProductQuantity"
            },
            "name": "productQuantity",
            "designerId": "14a6cca4-0dc6-4e6c-9316-53aa66442b2a"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productImage",
                "selector": "#ProductImage"
            },
            "name": "productImage",
            "designerId": "f58da8ee-d204-4d95-a30b-d1913eafba0b"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productViewWindow",
                "selector": "#ProductView"
            },
            "name": "productViewWindow",
            "designerId": "d5ccbb61-2d42-4ddc-a6fe-9c8c5bcd2396"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "totalItems",
                "selector": "#totalItems"
            },
            "name": "totalItems",
            "designerId": "425beba7-a7fb-48ee-b5d1-40030edac356"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "trayWindow",
                "selector": "#TrayWindow"
            },
            "name": "trayWindow",
            "designerId": "4fa1df45-24e7-448c-a118-a7eb8fe52341"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "trayGrid",
                "selector": "#trayGrid"
            },
            "name": "trayGrid",
            "designerId": "9feb6271-673d-421a-b8da-82b3054414ac"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "totalAmount",
                "selector": "#totalAmount"
            },
            "name": "totalAmount",
            "designerId": "77cfe088-1cf7-43e0-b1a3-54c7cd7393db"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#ProductView",
                "designer|targetType": "ProductViewWindow",
                "fn": "onProductViewActivate",
                "implHandler": [
                    "Ext.getBody().mask();",
                    "var data = window.selectedProduct,",
                    "    img = this.getProductImage(),",
                    "    productName = this.getProductName(),",
                    "    productDescription = this.getProductDescription(),",
                    "    productPrice = this.getProductPrice(),",
                    "    productId = this.getProductId();",
                    "",
                    "img.setSrc(data.Image);",
                    "productName.setValue(data.Name);",
                    "productDescription.setValue(data.Description);",
                    "productPrice.setValue(data.Price);",
                    "productId.setValue(data.Id);"
                ],
                "name": "activate",
                "scope": "me"
            },
            "name": "onProductViewActivate",
            "designerId": "6440f0c7-ce60-41b1-baf3-8c2d9aea8da5"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#CancelCartButton",
                "designer|targetType": "MyButton12",
                "fn": "onCancelCartButtonClick",
                "implHandler": [
                    "        this.getProductViewWindow().destroy();",
                    "        Ext.getBody().unmask();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onCancelCartButtonClick",
            "designerId": "700cca1f-9c22-4013-8a30-5c15e58c8aa9"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#AddCartButton",
                "designer|targetType": "MyButton11",
                "fn": "onAddCartButtonClick",
                "implHandler": [
                    "",
                    "var trayStore = Ext.getStore('TrayStore'),",
                    "    productName = this.getProductName().getValue(),",
                    "    productQuantity = this.getProductQuantity().getValue(),",
                    "    productPrice = this.getProductPrice().getValue(),",
                    "    productId= this.getProductId().getValue();",
                    "",
                    "var tray = {",
                    "    Id: productId,",
                    "    Name: productName,",
                    "    Quantity: productQuantity,",
                    "    Price: productPrice,",
                    "    Total: productQuantity * productPrice",
                    "};",
                    "",
                    "",
                    "var totalItems = 0;",
                    "    var index = trayStore.find('Id', productId);",
                    "    if(index === -1){",
                    "        trayStore.add(tray);",
                    "    }else{",
                    "        var currentQuantity = trayStore.getAt(index).data.Quantity,",
                    "            replaceQuantity = currentQuantity + productQuantity;",
                    "            trayStore.getAt(index).data.Quantity = replaceQuantity;",
                    "",
                    "//         totalItems += replaceQuantity;",
                    "//      this.getTotalItems().setValue(totalItems);",
                    "    }",
                    "//     Ext.create('ProductViewWindow').hide();",
                    "Ext.Msg.alert('Status', this.added_to_cart);",
                    "console.log(this.invalid_login);",
                    "this.getProductViewWindow().destroy();",
                    "Ext.getBody().unmask();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onAddCartButtonClick",
            "designerId": "62d82126-3b6c-4170-abdb-73cb88d89992"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#cancelCheckoutBtn",
                "designer|targetType": "MyButton15",
                "fn": "onCancelCheckoutBtnClick",
                "implHandler": [
                    "this.getTrayWindow().destroy();",
                    "Ext.getBody().unmask();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onCancelCheckoutBtnClick",
            "designerId": "f068b776-9ca7-4699-b9e3-4fdf0e02a1b0"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#removeItemBtn",
                "designer|targetType": "MyButton13",
                "fn": "onRemoveItemBtnClick",
                "implHandler": [
                    "var trayStore = Ext.getStore('TrayStore');",
                    "",
                    "var trayGrid = this.getTrayGrid(),",
                    "    selectModel = trayGrid.getSelectionModel(),",
                    "    selectedProduct = selectModel.getSelection(),",
                    "    selectedQty = selectedProduct[0].data.Quantity,",
                    "    selectedPrice = selectedProduct[0].data.Price;",
                    "",
                    "var currentQty = this.getTotalItems().getValue(),",
                    "    currentAmount = this.getTotalAmount().getValue();",
                    "",
                    "var updatedQty = currentQty - selectedQty,",
                    "    updatedAmount = currentAmount - selectedPrice;",
                    "",
                    "trayStore.remove(selectedProduct);",
                    "this.getTotalItems().setValue(updatedQty);",
                    "this.getTotalAmount().setValue(updatedAmount);",
                    "",
                    "",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onRemoveItemBtnClick",
            "designerId": "3cd710d8-4b9c-4207-9787-cc99779c9128"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#TrayWindow",
                "designer|targetType": "TrayWindow",
                "fn": "onTrayWindowShow",
                "implHandler": [
                    "    var grid = this.getTrayGrid(),",
                    "        store = grid.getStore(),",
                    "        totalQuantity = 0,",
                    "        totalAmount = 0,",
                    "        records = store.getRange();",
                    "",
                    "    Ext.each(records,function(record){",
                    "           totalQuantity += record.data.Quantity;",
                    "            totalAmount += record.data.Total;",
                    "    });",
                    "",
                    "    console.log(totalQuantity, totalAmount);",
                    "    ",
                    "    this.getTotalItems().setValue(totalQuantity);",
                    "    this.getTotalAmount().setValue(totalAmount);",
                    ""
                ],
                "name": "show",
                "scope": "me"
            },
            "name": "onTrayWindowShow",
            "designerId": "084d651f-b6b7-4748-aa05-a79bc6105ea2"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "productId",
                "selector": "#productId"
            },
            "name": "productId",
            "designerId": "6242d23f-abe8-4d4b-a56b-81f9295c929e"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#registerWindowButton",
                "designer|targetType": "MyButton7",
                "fn": "onRegisterWindowButtonClick",
                "implHandler": [
                    "        var form = this.getRegisterForm(),",
                    "        username = form.getValues().username,",
                    "            password = form.getValues().password,",
                    "            firstname = form.getValues().firstname,",
                    "            middlename = form.getValues().middlename,",
                    "            lastname = form.getValues().lastname,",
                    "            address = form.getValues().address,",
                    "            contactno = form.getValues().contactno,",
                    "            email = form.getValues().email,",
                    "            gender = form.getValues().gender;",
                    "        if(form.isValid()){",
                    "             Ext.Ajax.request({",
                    "                     url : 'user/addUser',",
                    "                     params : {",
                    "                         'username':username,",
                    "                         'password':password,",
                    "                         'firstname':firstname,",
                    "                         'middlename':middlename,",
                    "                         'lastname':lastname,",
                    "                         'address':address,",
                    "                         'contactno':contactno,",
                    "                         'email':email,",
                    "                         'gender':gender",
                    "                     },",
                    "                     scope : this,",
                    "                     success : function(response) {",
                    "                         close();",
                    "                     }",
                    "                });",
                    "        }"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onRegisterWindowButtonClick",
            "designerId": "72d77a22-9256-4bc3-8823-52a739f8798e"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "registerForm",
                "selector": "#registerForm"
            },
            "name": "registerForm",
            "designerId": "236e1667-4add-459f-8f16-8142df7f9650"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "loginForm",
                "selector": "#loginForm"
            },
            "name": "loginForm",
            "designerId": "e0359952-58b1-4a3c-b260-f23b52269e8d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#loginWindowButton",
                "designer|targetType": "MyButton9",
                "fn": "onLoginWindowButtonClick",
                "implHandler": [
                    "        var form = this.getLoginForm(),",
                    "                    username = form.getValues().username,",
                    "                    password = form.getValues().password;",
                    "",
                    "            if(form.isValid()){",
                    "                Ext.Ajax.request({",
                    "                     url : 'login',",
                    "                     params : {",
                    "                         'username':username,",
                    "                         'password':password",
                    "                     },",
                    "                     scope : this,",
                    "                     success : function(response) {",
                    "                         close();",
                    "                     }",
                    "                });",
                    "            }"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onLoginWindowButtonClick",
            "designerId": "3e96936b-9662-4979-a024-c56c8e4cd84c"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#cancelRegisterButton",
                "designer|targetType": "MyButton8",
                "fn": "onCancelRegisterButtonClick",
                "implHandler": [
                    "        this.getRegisterWindow().destroy();",
                    "        Ext.getBody().unmask();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onCancelRegisterButtonClick",
            "designerId": "f41ed9a2-58cc-4a10-9c10-2f3f77badcdb"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "registerWindow",
                "selector": "#registerWindow"
            },
            "name": "registerWindow",
            "designerId": "c1b3c6ac-99db-4c73-aba3-7377c375c794"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "loginWindow",
                "selector": "#loginWindow"
            },
            "name": "loginWindow",
            "designerId": "0b99aa7c-21a9-4c0b-9228-1a0d07c81766"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#cancelLoginButton",
                "designer|targetType": "MyButton10",
                "fn": "onCancelLoginButtonClick",
                "implHandler": [
                    "        this.getLoginWindow().destroy();",
                    "        Ext.getBody().unmask();"
                ],
                "name": "click",
                "scope": "me"
            },
            "name": "onCancelLoginButtonClick",
            "designerId": "361a2e2f-09e3-4c7a-868e-60aea2b979ca"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "showLoadingMessageMask",
                "implHandler": [
                    "                    if (!this.oLoadingMessageMask) {",
                    "                       this.oLoadingMessageMask = new Ext.LoadMask(Ext.getBody(), {",
                    "                          msg : \"Loading, please wait...\"",
                    "                       });",
                    "                    }",
                    "                    this.oLoadingMessageMask.show();"
                ]
            },
            "name": "showLoadingMessageMask",
            "designerId": "7b3757cd-32d2-4a23-be48-919e836a82bb"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "hideLoadingMessageMask",
                "implHandler": [
                    "",
                    "                    if (this.oLoadingMessageMask) {",
                    "                       this.oLoadingMessageMask.hide();",
                    "                    }"
                ]
            },
            "name": "hideLoadingMessageMask",
            "designerId": "9ea85473-2551-4ec4-9502-3ffacd596c77"
        }
    ]
}