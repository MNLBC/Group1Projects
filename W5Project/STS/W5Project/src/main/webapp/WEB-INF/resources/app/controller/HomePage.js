/*
 * File: app/controller/HomePage.js
 *
 * This file was generated by Sencha Architect version 3.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('BurgerQueen.controller.HomePage', {
    extend: 'Ext.app.Controller',

    mixins: {
        GlobalUtil: 'com.oocl.mnlbc.GlobalMessage'
    },

    refs: [
        {
            ref: 'beveragesButton',
            selector: '#beveragesButton'
        },
        {
            ref: 'chickensButton',
            selector: '#chickensButton'
        },
        {
            ref: 'dessertsButton',
            selector: '#dessertsButton'
        },
        {
            ref: 'loginButton',
            selector: '#loginButton'
        },
        {
            ref: 'logoutButton',
            selector: '#logoutButton'
        },
        {
            ref: 'productGrid',
            selector: '#ProductGrid'
        },
        {
            ref: 'productViewWindow',
            selector: '#ProductView'
        },
        {
            ref: 'products',
            selector: '#Products'
        },
        {
            ref: 'userProfile',
            selector: '#UserProfile'
        },
        {
            ref: 'sidesButton',
            selector: '#sidesButton'
        },
        {
            ref: 'trayButton',
            selector: '#trayButton'
        },
        {
            ref: 'registerButton',
            selector: '#registerButton'
        },
        {
            ref: 'myProfileButton',
            selector: '#myProfileButton'
        }
    ],

    onLoginButtonClick: function() {
                Ext.create('BurgerQueen.view.LoginWindow').show();
    },

    onBeveragesButtonClick: function() {

                var productStore = this.productStore;

                productStore.clearFilter();
                productStore.filter('Category','Beverages');



    },

    onBurgersButtonClick: function() {
                     var productStore = this.productStore;

                        productStore.clearFilter();
                        productStore.filter('Category','Burgers');
    },

    onChickensButtonClick: function() {
                 var productStore = this.productStore;

                        productStore.clearFilter();
                        productStore.filter('Category','Chickens');
    },

    onDessertsButtonClick: function() {
             var productStore = this.productStore;

                        productStore.clearFilter();
                        productStore.filter('Category','Desserts');
    },

    onLogoutButtonClick: function() {

    },

    onProductGridItemDblClick: function() {
                 var productStore = this.productStore;

                var productGrid = this.getProductGrid(),
                    selectModel = productGrid.getSelectionModel(),
                    selectedProduct = selectModel.getSelection()[0].data;

        //         var selectedProductName = selectedProduct.name,
        //         	selectedProductPrice = selectedProduct.price,
        //         	selectedProductDesc = selectedProduct.description;

        //         this.getProductName().setValue(selectedProductName);
        //         this.getProductPrice().setValue(selectedProductPrice);
        //         this.getProductDesc().setValue(selectedProductDesc);

                var productWin = Ext.create('BurgerQueen.view.ProductViewWindow',{selectedProduct: selectedProduct});
                productWin.show();
    },

    onTrayBtnClick: function() {
         Ext.create('BurgerQueen.view.TrayWindow').show();
    },

    onRegisterButtonClick: function() {
               Ext.create('BurgerQueen.view.RegisterWindow').show();
    },

    onTrayButtonClick: function() {
         Ext.create('BurgerQueen.view.TrayWindow').show();
    },

    onLogoutButtonClick: function() {
                                        this.getLoginButton().show();
                                         this.getLogoutButton().hide();
                                         this.getRegisterButton().show();
                                         this.getMyProfileButton().hide();
                                         this.getTrayButton().hide();
                                Ext.getStore('TrayStore').removeAll();
    },

    onMyProfileButtonClick: function() {
                this.getProducts().hide();
                this.getUserProfile().show();

                //var userStore = Ext.getStore('UserStore');

                // Ext.each(userStore, function(record){
                //     var userName = record.get('userName'),
                //         firstName = record.get('firstName'),
                //         middleName =  record.get('middleName'),
                //         lastName = record.get('lastName'),
                //         address = record.get('address'),
                //         email = record.get('email'),
                //         contactNum = record.get('contactNum');

                //     this.getUserNameField().setValue(userName);
                //     this.getFirstNameField().setValue(firstName);
                //     this.getMiddleNameField().setValue(middleName);
                //     this.getLastNameField().setValue(lastName);
                //     this.getAddressField().setValue(address);
                //     this.getEmailField().setValue(email);
                // });
    },

    onBurgerQueenRender: function() {
        var store = Ext.getStore('ProductStore');

        Ext.Ajax.request({
            url : 'meal/getAllMeals',
            params : {

            },
            scope : this,
            success : function(response) {
                var data = Ext.decode(response.responseText);
                Ext.each(data, function(record){
                    var product = {
                        Id:record.id,
                        Code:record.code,
                        Name:record.name,
                        Description:record.description,
                        Category:record.category,
                        Price:record.price,
                        Image:record.image
                    };
                    store.add(product);
                });
            }
        });
    },

    onLaunch: function() {
                this.productStore = Ext.getStore('ProductStore');

    },

    showLoadingMessageMask: function() {
                            if (!this.oLoadingMessageMask) {
                               this.oLoadingMessageMask = new Ext.LoadMask(Ext.getBody(), {
                                  msg : "Loading, please wait..."
                               });
                            }
                            this.oLoadingMessageMask.show();
    },

    hideLoadingMessageMask: function() {

                            if (this.oLoadingMessageMask) {
                               this.oLoadingMessageMask.hide();
                            }
    },

    init: function(application) {
        this.control({
            "#loginButton": {
                click: this.onLoginButtonClick
            },
            "#beveragesButton": {
                click: this.onBeveragesButtonClick
            },
            "#burgersButton": {
                click: this.onBurgersButtonClick
            },
            "#chickensButton": {
                click: this.onChickensButtonClick
            },
            "#dessertsButton": {
                click: this.onDessertsButtonClick
            },
            "#logoutButton": {
                click: this.onLogoutButtonClick,
                click: this.onLogoutButtonClick
            },
            "#ProductGrid": {
                itemdblclick: this.onProductGridItemDblClick
            },
            "#trayBtn": {
                click: this.onTrayBtnClick
            },
            "#registerButton": {
                click: this.onRegisterButtonClick
            },
            "#trayButton": {
                click: this.onTrayButtonClick
            },
            "#myProfileButton": {
                click: this.onMyProfileButtonClick
            },
            "#BurgerQueen": {
                render: this.onBurgerQueenRender
            }
        });
    }

});
